import pickle

locations = ['03953', '04220', '04270', '04360', '08508', '70133',
             '70200', '70219', '70231', '70261', '70273', '70316',
             '70326', '70350', '70398', '70414', '71043', '71081',
             '71109', '71119', '71126', '71600', '71603', '71722',
             '71811', '71815', '71816', '71823', '71836', '71845',
             '71867', '71906', '71907', '71908', '71909', '71913',
             '71924', '71925', '71926', '71934', '71945', '71957',
             '71964', '72201', '72202', '72206', '72208', '72210',
             '72214', '72215', '72230', '72233', '72235', '72240',
             '72248', '72249', '72251', '72261', '72265', '72274',
             '72293', '72305', '72317', '72318', '72327', '72340',
             '72357', '72363', '72364', '72365', '72376', '72388',
             '72393', '72402', '72403', '72426', '72440', '72451',
             '72456', '72469', '72476', '72489', '72493', '72501',
             '72518', '72520', '72528', '72558', '72562', '72572',
             '72582', '72597', '72632', '72634', '72645', '72649',
             '72659', '72662', '72672', '72681', '72694', '72712',
             '72747', '72764', '72768', '72776', '72786', '72797',
             '74005', '74389', '74455', '74494', '74560', '74646',
             '74794', '76256', '76394', '76458', '76526', '76595',
             '76612', '76644', '76654', '76679', '76805', '78016',
             '78073', '78384', '78397', '78486', '78526', '78583',
             '78807', '78897', '78954', '78970', '91285', '80222',
             '82022', '91165', '91285']

years = ['2000','2001','2002','2003','2004','2005','2006','2007','2008',
         '2009','2010','2011','2012','2013','2014','2015','2016','2017','2018']

filename = locations[0] + '_' + years[-1]
data = pickle.load(open(filename + '.p','rb'))

database = {key:[] for key in data.keys()}

locations_saved = []
locations_not_saved = []

for location in locations:
    try:
        filename = location + '_' + years[-1]
        data = pickle.load(open(filename + '.p','rb'))

        for i in range(len(data['humidity'])):
            for key in database.keys():
                if key != 'noise':
                    database[key].append(data[key][i])

        locations_saved.append(location)
    except:
        # print('Location %s not saved yet.' % location)
        locations_not_saved.append(location)

print('Locations not saved %s' % locations_not_saved)

# save_years = years[0] + '-' + years[-1]
if not locations_not_saved:
    save_locations = 'all_locations_%s' % years[-1]
else:
    save_locations = '%s-%s' % (locations_saved[0], locations_saved[-2])

directory = '2018/'
f = open(directory + save_locations + '.p','wb')
pickle.dump(database, f)
f.close()
